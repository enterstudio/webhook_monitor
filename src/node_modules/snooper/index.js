var all_sockets = null;

exports.set_sockets = function  (sockets) {
    all_sockets = sockets;
};

exports.connect_snooper = function  (config) {

    config.socket.emit('connected', {message: 'Connected to webhook monitor. Join a room.'});
    
    config.socket.on('webhook', function  (data) {
        all_sockets.emit('webhook', {message: config.username + ' says: ' + data.message});
    });
    
    
    config.socket.on('join', function  (data) {
        console.log('Got Join: ' + data);
        config.socket.join(data.message);
    });
};

exports.failure = function  (socket) {
    socket.emit('error', {message: 'Please login to the webhook viewer.'});
};
